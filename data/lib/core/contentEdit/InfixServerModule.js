(function(){(function(q){function g(c){if(n[c])return n[c].exports;var f=n[c]={i:c,l:!1,exports:{}};q[c].call(f.exports,f,f.exports,g);f.l=!0;return f.exports}var n={};g.m=q;g.c=n;g.d=function(c,f,l){g.o(c,f)||Object.defineProperty(c,f,{enumerable:!0,get:l})};g.r=function(c){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"});Object.defineProperty(c,"__esModule",{value:!0})};g.t=function(c,f){f&1&&(c=g(c));if(f&8||f&4&&"object"===typeof c&&c&&c.__esModule)return c;
var l=Object.create(null);g.r(l);Object.defineProperty(l,"default",{enumerable:!0,value:c});if(f&2&&"string"!=typeof c)for(var r in c)g.d(l,r,function(p){return c[p]}.bind(null,r));return l};g.n=function(c){var f=c&&c.__esModule?function(){return c["default"]}:function(){return c};g.d(f,"a",f);return f};g.o=function(c,f){return Object.prototype.hasOwnProperty.call(c,f)};g.p="/core/contentEdit";return g(g.s=0)})([function(q,g,n){q.exports=n(1)},function(q,g,n){function c(a,d,b){commandFName="importCommand"+
b+".xml";FS.writeFile(commandFName,"<InfixServer>"+a+"</InfixServer>");t.ccall("wasmRunXML","number",["string","string"],[commandFName,d]);FS.unlink(commandFName)}function f(){1==r?postMessage({cmd:"isReady"}):setTimeout(f,300)}function l(a,d,b,e,h){d?(b=new Uint8Array(b),d="inputFile"+a+".pdf",FS.writeFile(d,b),e=new Uint8Array(e),e=(new TextDecoder("utf-8")).decode(e),exportedFName="exported"+a+".xml",objectFName="objects"+a+".xml",resultsFName="results"+a+".xml",b='<Commands><Command Name="LoadPDF"><File>'+
(d+'</File></Command><Command Name="Page BBox"><StartPage>1</StartPage><EndPage>1</EndPage></Command>'),""!=e&&(b+='<Command Name="AddTableBoxes">'+e+"</Command>"),b=b+'<Command Name="Translate Export"><File>'+(exportedFName+"</File><TransXML>coreTransXML.cfg</TransXML>"),b=b+'<StartPage>1</StartPage><EndPage>1</EndPage></Command><Command Name="Edit Page"><Output>'+(objectFName+"</Output><ImagesOnly/></Command></Commands>"),c(b,resultsFName,1),p=a,h&&(h=FS.readFile(d).buffer,d=FS.readFile(exportedFName).buffer,
e=FS.readFile(objectFName).buffer,b=FS.readFile(resultsFName).buffer,FS.unlink(resultsFName),FS.unlink(exportedFName),FS.unlink(objectFName),hasBeenExported=!0,postMessage({cmd:"exportFile",pageNumber:a,exportPerformed:!0,pdfBuffer:h,exportXML:d,objectXML:e,resultsXML:b},[h,d,b]))):postMessage({cmd:"exportFile",pageNumber:a,exportPerformed:!1})}var r=!1,p=-1,t={noInitialRun:!0,onRuntimeInitialized:function(){r=!0}};self.Module=t;importScripts("InfixServer.js");onmessage=function(a){a=a.data;switch(a.cmd){case "isReady":f();
break;case "initialiseInfixServer":a=a.l;t.callMain([""]);t.ccall("wasmInitInfixServer","number",["string","string","string"],["infixcore.cfg",a,"results"]);a=FS.readFile("results").buffer;postMessage({cmd:"initialiseInfixServer",resultsXML:a},[a]);break;case "exportFile":l(a.pageNumber,a.performExport,a.pdfFile,a.tableData,!0);break;case "importText":var d=a.pdfFile,b=a.pageNumber,e=a.webFontURL,h=a.galleyId,m=a.tableData;a=new Uint8Array(a.importData);var k=(new TextDecoder("utf-8")).decode(a);
b!=p&&l(b,!0,d,m,!1);a="editText"+b+".xml";FS.writeFile(a,k);d="outputFile"+b+".pdf";m=resultsFName="results"+b+".xml";k='<Commands><Command Name="Translate Import"><File>'+(a+'</File><StartPage>1</StartPage><EndPage>LastPage</EndPage><AutoSubstitute/><AutoDeleteParas/><Fitting><Shrink><FontSize Min="0.65">true</FontSize><Leading>False</Leading></Shrink><Stretch><FontSize>False</FontSize>');k+="<Leading>False</Leading></Stretch></Fitting>";k+="<ResetLetterSpacing/><IgnoreFlightCheck/>";k+="<MissingFont>Noto Sans Regular</MissingFont><SubstituteAllChars/>";
k+="<WebFontURL>"+e+"</WebFontURL>";k+="<TargetLang>en</TargetLang></Command>";k+='<Command Name="SavePDF"><File>'+d+"</File></Command>";k+='<Command Name="DumpObjectBBox"><GID>'+h+"</GID></Command></Commands>";c(k,m,b);e=FS.readFile(d).buffer;m=FS.readFile(resultsFName).buffer;FS.unlink(d);FS.unlink(resultsFName);FS.unlink(a);postMessage({cmd:"importText",pageNumber:b,pdfBuffer:e,resultsXML:m,id:h},[e,m]);break;case "transformObject":b=a.pageNumber;h=a.objectID;var u=a.isText;e=a.topVal;d=a.leftVal;
m=a.bottomVal;k=a.rightVal;var v='<Commands><Command Name="TransformToRect">';b!=p&&l(b,!0,a.pdfFile,a.tableData,!1);a="outputFile"+b+".pdf";resultsFName="results"+b+".xml";u=!0===u?"<GID>"+h+"</GID>":"<OID>"+h+"</OID>";v=v+u+("<Rect><Top>"+e+"</Top><Left>"+d+"</Left><Bottom>")+(m+"</Bottom><Right>"+k+"</Right></Rect></Command>");v+='<Command Name="SavePDF"><File>'+a+"</File></Command>";c(v+('<Command Name="DumpObjectBBox">'+u+"</Command></Commands>"),resultsFName,b);e=FS.readFile(a).buffer;d=FS.readFile(resultsFName).buffer;
FS.unlink(a);FS.unlink(resultsFName);postMessage({cmd:"transformObject",pageNumber:b,pdfBuffer:e,resultsXML:d,id:h},[e,d]);break;case "deleteObject":b=a.pageNumber,h=a.objectID,e=a.isText,b!=p&&l(b,!0,a.pdfFile,a.tableData,!1),a="outputFile"+b+".pdf",resultsFName="results"+b+".xml",d='<Commands><Command Name="DeleteObject">',d=(!0===e?d+("<GID>"+h+"</GID></Command>"):d+("<OID>"+h+"</OID></Command>"))+('<Command Name="SavePDF"><File>'+a+"</File></Command></Commands>"),c(d,resultsFName,b),e=FS.readFile(a).buffer,
d=FS.readFile(resultsFName).buffer,FS.unlink(a),FS.unlink(resultsFName),postMessage({cmd:"deleteObject",pageNumber:b,pdfBuffer:e,resultsXML:d,id:h},[e,d])}}}]);}).call(this || window)
